# Alert: This file is auto generated.
# Students: You may edit it by hand, but your changes might be overridden for each new assignment release.
# Instructors: If you are editing CI-jobs in the material repo,
# put your jobs in a separate .gitlab-ci.yml inside the assignment subdirectory.
# After editing any gitlab-ci.yml files, re-run the aggregator from the repository
# root directory (util/generate_gitlab_ci.py). Alternatively, ensure that the git pre-commit hooks are
# active so that the file is regenerated automatically.
Assignment2:
  stage: test
  script:
    - cd assignment2/src/
    - srun make -B assignment2
    - srun stdbuf --output=L ./assignment2 | tee ./perf_data.txt
    - python3 ../util/generate_chart.py --output-file perf_data.svg
    - python3 ../util/generate_chart.py --output-file perf_data.pdf
  artifacts:
    paths:
    - assignment2/src/perf_data.pdf
    - assignment2/src/perf_data.svg
    - assignment2/src/perf_data.txt
    expire_in: 6 months
    when: always
  only:
    - main

